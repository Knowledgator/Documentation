import MultiTaskTable from './tables/MultiTaskTable';
import BiEncoderTable from './tables/BiEncoderTable';
import GlinerBiomedTable from './tables/GlinerBiomedTable';


# Pretrained Models

Welcome to the Gliner Framework Quickstart Guide! This document will help you get started with the basics of using Gliner.

## Multitask Models

<MultiTaskTable />


### Classification
   ```python
   from gliner import GLiNER
   from gliner.multitask import GLiNERClassifier

   model_id = 'knowledgator/gliner-multitask-v1.0'
   model = GLiNER.from_pretrained(model_id)
   classifier = GLiNERClassifier(model=model)
   text = "SpaceX successfully launched a new rocket into orbit."
   labels = ['science', 'technology', 'business', 'sports']
   predictions = classifier(text, classes=labels, multi_label=False)
   print(predictions)
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    [[{'label': 'technology', 'score': 0.3839840292930603}]]
    ```
   </details>

### Question-Answering
   ```python
   from gliner import GLiNER
   from gliner.multitask import GLiNERQuestionAnswerer

   model_id = 'knowledgator/gliner-multitask-v1.0'
   model = GLiNER.from_pretrained(model_id)
   answerer = GLiNERQuestionAnswerer(model=model)
   text = "SpaceX successfully launched a new rocket into orbit."
   question = 'Which company launched a new rocket?'
   predictions = answerer(text, questions=question)
   print(predictions)
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    [[{'answer': 'SpaceX', 'score': 0.998126208782196}]]
    ```
   </details>


### Relation Extraction

   ```python
   from gliner import GLiNER
   from gliner.multitask import GLiNERRelationExtractor

   model_id = 'knowledgator/gliner-multitask-v1.0'
   model = GLiNER.from_pretrained(model_id)
   relation_extractor = GLiNERRelationExtractor(model=model)
   text = "Elon Musk founded SpaceX in 2002 to reduce space transportation costs."
   relations = ['founded', 'owns', 'works for']
   entities = ['person', 'company', 'year']
   predictions = relation_extractor(text, entities=entities, relations=relations)
   print(predictions)
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    [[{'source': 'Elon Musk', 'relation': 'founded', 'target': 'SpaceX', 'score': 0.9583475589752197}]]
    ```
   </details>


### Open Information Extraction

   ```python
   from gliner import GLiNER
   from gliner.multitask import GLiNEROpenExtractor

   model_id = 'knowledgator/gliner-multitask-v1.0'
   model = GLiNER.from_pretrained(model_id)
   extractor = GLiNEROpenExtractor(model=model, prompt="Extract all companies related to space technologies")
   text = "Elon Musk founded SpaceX in 2002 to reduce space transportation costs. Also Elon is founder of Tesla, NeuroLink and many other companies."
   labels = ['company']
   predictions = extractor(text, labels=labels)
   print(predictions)
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    [[{'start': 72, 'end': 78, 'text': 'SpaceX', 'label': 'company', 'score': 0.9622299075126648}, {'start': 149, 'end': 154, 'text': 'Tesla', 'label': 'company', 'score': 0.9357912540435791}, {'start': 156, 'end': 165, 'text': 'NeuroLink', 'label': 'company', 'score': 0.9122058749198914}]]
    ```
   </details>


### Summarization

   ```python
   from gliner import GLiNER
   from gliner.multitask import GLiNERSummarizer

   model_id = 'knowledgator/gliner-multitask-v1.0'
   model = GLiNER.from_pretrained(model_id)
   summarizer = GLiNERSummarizer(model=model)
   text = "Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975 to develop and sell BASIC interpreters for the Altair 8800. During his career at Microsoft, Gates held the positions of chairman, chief executive officer, president and chief software architect, while also being the largest individual shareholder until May 2014."
   summary = summarizer(text, threshold=0.1)
   print(summary)
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    ['Microsoft was founded by Bill Gates and Paul Allen on April 4, 1975 to develop and sell BASIC interpreters for the Altair 8800. During his career at Microsoft, Gates held the positions of chairman, chief executive officer, president and chief software architect, while also being the largest individual shareholder until May 2014.']

    ```
   </details>

### [More details on usage](frameworks\gliner\usage\index.md#pipelines)

## Bi-Encoder Models

<BiEncoderTable />

### Basic Usage
   ```python
   from gliner import GLiNER

   model = GLiNER.from_pretrained("knowledgator/modern-gliner-bi-base-v1.0")

   text = """
   Cristiano Ronaldo dos Santos Aveiro (Portuguese pronunciation:    [kɾiʃˈtjɐnu ʁɔˈnaldu]; born 5 February 1985) is a Portuguese   professional footballer who plays as a forward for and captains both   Saudi Pro League club Al Nassr and the Portugal national team. Widely  regarded as one of the greatest players of all time, Ronaldo has won  five Ballon d'Or awards,[note 3] a record three UEFA Men's Player of the    Year Awards, and four European Golden Shoes, the most by a European  player. He has won 33 trophies in his career, including seven league  titles, five UEFA Champions Leagues, the UEFA European Championship and  the UEFA Nations League. Ronaldo holds the records for most appearances  (183), goals (140) and assists (42) in the Champions League, goals in    the European Championship (14), international goals (128) and  international appearances (205). He is one of the few players to have    made over 1,200 professional career appearances, the most by an outfield   player, and has scored over 850 official senior career goals for club  and country, making him the top goalscorer of all time.
   """

   labels = ["person", "award", "date", "competitions", "teams"]

   entities = model.predict_entities(text, labels, threshold=0.3)

   for entity in entities:
       print(entity["text"], "=>", entity["label"])
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    Cristiano Ronaldo dos Santos Aveiro => person
    5 February 1985 => date
    Al Nassr => teams
    Portugal national team => teams
    Ballon d'Or => award
    UEFA Men's Player of the Year Awards => award
    European Golden Shoes => award
    UEFA Champions Leagues => competitions
    UEFA European Championship => competitions
    UEFA Nations League => competitions
    Champions League => competitions
    European Championship => competitions
    ```
   </details>

### Pre-compute Labels Embeddings
   ```python
   text = """
   Cristiano Ronaldo dos Santos Aveiro (Portuguese pronunciation:       [kɾiʃˈtjɐnu ʁɔˈnaldu]; born 5 February 1985) is a Portuguese      professional footballer who plays as a forward for and captains both    Saudi Pro League club Al Nassr and the Portugal national team. Widely    regarded as one of the greatest players of all time, Ronaldo has won   five Ballon d'Or awards,[note 3] a record three UEFA Men's Player of  the    Year Awards, and four European Golden Shoes, the most by a  European  player. He has won 33 trophies in his career, including seven  league  titles, five UEFA Champions Leagues, the UEFA European  Championship and  the UEFA Nations League. Ronaldo holds the records for    most appearances  (183), goals (140) and assists (42) in the Champions  League, goals in    the European Championship (14), international goals  (128) and  international appearances (205). He is one of the few players    to have    made over 1,200 professional career appearances, the most by    an outfield   player, and has scored over 850 official senior career    goals for club  and country, making him the top goalscorer of all time.
   """

   labels = ["person", "award", "date", "competitions", "teams"]

   entity_embeddings = model.encode_labels(labels, batch_size = 8)

   output = model.batch_predict_with_embeds([text], entity_embeddings,  labels)
   for entities in output:
     for entity in entities:
         print(entity["text"], "=>", entity["label"])
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    Encoding labels: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]
    Cristiano Ronaldo dos Santos Aveiro => person
    5 February 1985 => date
    Ballon d'Or => award
    UEFA Men's Player of the    Year Awards => award
    European Golden Shoes => award
    UEFA Champions Leagues => competitions
    UEFA European Championship => competitions
    UEFA Nations League => competitions
    ```
   </details>

## GLiNER-BioMed
GLiNER-biomed developed in collaboration with [DS4DH](https://www.unige.ch/medecine/radio/en/research-groups/1035teodoro) from the University of Geneva, introduces a specialized suite of efficient open biomedical NER models based on the GLiNER framework. GLiNER-biomed leverages synthetic annotations distilled from large generative biomedical language models to achieve state-of-the-art zero-shot and few-shot performance in biomedical entity recognition tasks.

<GlinerBiomedTable />

### Basic Usage
   ```python
   from gliner import GLiNER

   model = GLiNER.from_pretrained("Ihor/gliner-biomed-bi-base-v1.0")

   text = """
   The patient, a 45-year-old male, was diagnosed with type 2 diabetes mellitus and hypertension.
   He was prescribed Metformin 500mg twice daily and Lisinopril 10mg once daily. 
   A recent lab test showed elevated HbA1c levels at 8.2%.
   """

   labels = ["Disease", "Drug", "Drug dosage", "Drug frequency", "Lab test", "Lab test value", "Demographic information"]

   entities = model.predict_entities(text, labels, threshold=0.5)

   for entity in entities:
       print(entity["text"], "=>", entity["label"])

   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    45-year-old male => Demographic information
    type 2 diabetes mellitus => Disease
    hypertension => Disease
    Metformin => Drug
    500mg => Drug dosage
    twice daily => Drug frequency
    Lisinopril => Drug
    10mg => Drug dosage
    once daily => Drug frequency
    HbA1c levels => Lab test
    8.2% => Lab test value
    ```
   </details>

### Pre-compute Labels Embeddings
   ```python
   text = """
   The patient, a 45-year-old male, was diagnosed with type 2 diabetes mellitus and hypertension.
   He was prescribed Metformin 500mg twice daily and Lisinopril 10mg once daily. 
   A recent lab test showed elevated HbA1c levels at 8.2%.
   """

   labels = ["Disease", "Drug", "Drug dosage", "Drug frequency", "Lab test", "Lab test value", "Demographic information"]

   entity_embeddings = model.encode_labels(labels, batch_size = 8)

   output = model.batch_predict_with_embeds([text], entity_embeddings,  labels)
   for entities in output:
     for entity in entities:
         print(entity["text"], "=>", entity["label"])
   ```
   <details>
    <summary>Expected Output</summary>
    ```bash
    Encoding labels: 100%|██████████| 1/1 [00:00<00:00,  2.51it/s]
    45-year-old male => Demographic information
    type 2 diabetes mellitus => Disease
    hypertension => Disease
    Metformin => Drug
    500mg => Drug dosage
    twice daily => Drug frequency
    Lisinopril => Drug
    10mg => Drug dosage
    once daily => Drug frequency
    HbA1c levels => Lab test
    8.2% => Lab test value
    ```
   </details>